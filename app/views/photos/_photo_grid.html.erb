<% photos.each do |photo| %>
  <% next unless photo %> <!-- Skip nil photos -->
  <div class="photo-item group relative" data-photo-id="<%= photo.id %>">
    <div class="carousel-trigger block aspect-square bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer" 
         data-photo-id="<%= photo.id %>"
         data-photo-url="<%= photo.image.attached? ? url_for(photo.image) : '#' %>">
      <% if photo.image.attached? %>
        <%= image_tag photo.image, 
            alt: 'Photo', 
            class: 'w-full h-full object-cover group-hover:scale-105 transition-transform duration-300',
            loading: 'lazy' %>
      <% else %>
        <div class="w-full h-full flex items-center justify-center text-gray-400">
          <span class="text-4xl">ðŸ“·</span>
        </div>
      <% end %>
    </div>
    
    <!-- Delete Button (hidden by default) -->
    <div class="delete-button absolute inset-0 z-20 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-200 bg-black bg-opacity-30 rounded-lg" 
         data-album-edit-target="deleteButton"
         style="display: none;">
      <%= link_to album_photo_path(@album, photo), 
          method: :delete,
          data: { 
            turbo_method: :delete,
            turbo_confirm: 'Are you sure you want to delete this photo?',
            action: 'click->album-edit#deletePhoto'
          }, 
          class: "bg-red-600 bg-opacity-50 hover:bg-red-700 hover:bg-opacity-70 text-white p-3 rounded-full shadow-lg transition-colors pointer-events-auto flex items-center justify-center" do %>
        <span class="text-xl font-bold">&times;</span>
      <% end %>
    </div>
  </div>
<% end %>
